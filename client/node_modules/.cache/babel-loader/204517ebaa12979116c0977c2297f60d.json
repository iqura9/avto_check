{"ast":null,"code":"import axios from \"axios\";\nconst instance = axios.create({\n  baseURL: 'http://192.168.43.38:9000/'\n});\ninstance.interceptors.request.use(config => {\n  let accessToken = JSON.parse(String(localStorage.getItem('profile'))); //@ts-ignore\n\n  config.headers.Authorization = `Bearer ${accessToken && accessToken.accessToken}`;\n  return config;\n});\ninstance.interceptors.response.use(config => {\n  return config;\n}, async error => {\n  const originalRequest = error.config;\n\n  if (error.response.status == 401 && error.config && !error.config._isRetry) {\n    originalRequest._isRetry = true;\n\n    try {\n      const access = JSON.parse(String(localStorage.getItem('profile')));\n      const responce = await instance.post(`auth/refresh`, {\n        \"token\": access.refreshToken\n      }).then(res => res.data.accessToken);\n      access.accessToken = responce;\n      await localStorage.setItem('profile', JSON.stringify(access));\n      return instance.request(originalRequest);\n    } catch (e) {\n      console.log('НЕ АВТОРЕЗОВАН');\n    }\n  }\n\n  throw error;\n});\nexport const adminApi = {\n  getGoods() {\n    return instance.get(`api/cars`).then(res => res.data);\n  },\n\n  addNewFolder(data) {\n    return instance.post(`api/cars`, { ...data\n    }).then(res => res.data);\n  },\n\n  updateFolderName(id, data) {\n    return instance.put(`api/cars/${id}`, { ...data\n    }).then(res => res.data);\n  },\n\n  deleteFolder(id, userId) {\n    const mainId = `?id=${id}&userId=${userId}`;\n    return instance.delete(`api/cars${mainId}`).then(res => res.data);\n  },\n\n  loginMe(data) {\n    const {\n      email,\n      password\n    } = data;\n    return instance.post(`/auth/signIn`, {\n      email,\n      password\n    }).then(res => res.data);\n  },\n\n  signUp(data) {\n    return instance.post(`/auth/signUp`, data).then(res => res.data);\n  },\n\n  getFolders(id) {\n    return instance.get(`/api/users/${id}`).then(res => res.data);\n  },\n\n  addIdOfCar(data) {\n    return instance.post(`/api/users`, data).then(res => res.data);\n  }\n\n};","map":{"version":3,"sources":["/Users/iqura/web_storm_projects/avto/client/src/Api/Api.tsx"],"names":["axios","instance","create","baseURL","interceptors","request","use","config","accessToken","JSON","parse","String","localStorage","getItem","headers","Authorization","response","error","originalRequest","status","_isRetry","access","responce","post","refreshToken","then","res","data","setItem","stringify","e","console","log","adminApi","getGoods","get","addNewFolder","updateFolderName","id","put","deleteFolder","userId","mainId","delete","loginMe","email","password","signUp","getFolders","addIdOfCar"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAMA,MAAMC,QAAQ,GAAGD,KAAK,CAACE,MAAN,CAAa;AAC1BC,EAAAA,OAAO,EAAE;AADiB,CAAb,CAAjB;AAIAF,QAAQ,CAACG,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAAmCC,MAAD,IAAY;AAC1C,MAAIC,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAD,CAAjB,CAAlB,CAD0C,CAE1C;;AACAN,EAAAA,MAAM,CAACO,OAAP,CAAeC,aAAf,GAAgC,UAAUP,WAAW,IAAIA,WAAW,CAACA,WAAY,EAAjF;AACA,SAAOD,MAAP;AACH,CALD;AAMAN,QAAQ,CAACG,YAAT,CAAsBY,QAAtB,CAA+BV,GAA/B,CAAoCC,MAAD,IAAU;AACzC,SAAOA,MAAP;AACH,CAFD,EAEG,MAAMU,KAAN,IAAe;AACd,QAAMC,eAAe,GAAGD,KAAK,CAACV,MAA9B;;AACA,MAAGU,KAAK,CAACD,QAAN,CAAeG,MAAf,IAAyB,GAAzB,IAAgCF,KAAK,CAACV,MAAtC,IAAgD,CAACU,KAAK,CAACV,MAAN,CAAaa,QAAjE,EAA0E;AACtEF,IAAAA,eAAe,CAACE,QAAhB,GAA2B,IAA3B;;AACA,QAAG;AACC,YAAMC,MAAM,GAAGZ,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAD,CAAjB,CAAf;AACA,YAAMS,QAAQ,GAAG,MAAMrB,QAAQ,CAACsB,IAAT,CAAe,cAAf,EAA8B;AAAC,iBAASF,MAAM,CAACG;AAAjB,OAA9B,EAA8DC,IAA9D,CAAmEC,GAAG,IAAGA,GAAG,CAACC,IAAJ,CAASnB,WAAlF,CAAvB;AACAa,MAAAA,MAAM,CAACb,WAAP,GAAqBc,QAArB;AACA,YAAMV,YAAY,CAACgB,OAAb,CAAqB,SAArB,EAAgCnB,IAAI,CAACoB,SAAL,CAAeR,MAAf,CAAhC,CAAN;AACA,aAAOpB,QAAQ,CAACI,OAAT,CAAiBa,eAAjB,CAAP;AACH,KAND,CAME,OAAOY,CAAP,EAAS;AACPC,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACH;AACJ;;AACD,QAAMf,KAAN;AACH,CAjBD;AAkBA,OAAO,MAAMgB,QAAQ,GAAG;AACpBC,EAAAA,QAAQ,GAAG;AACP,WAAOjC,QAAQ,CAACkC,GAAT,CAA2B,UAA3B,EAAsCV,IAAtC,CAA2CC,GAAG,IAAGA,GAAG,CAACC,IAArD,CAAP;AACH,GAHmB;;AAIpBS,EAAAA,YAAY,CAACT,IAAD,EAAU;AAClB,WAAO1B,QAAQ,CAACsB,IAAT,CAAe,UAAf,EAA0B,EAAC,GAAGI;AAAJ,KAA1B,EAAqCF,IAArC,CAA0CC,GAAG,IAAEA,GAAG,CAACC,IAAnD,CAAP;AACH,GANmB;;AAOpBU,EAAAA,gBAAgB,CAACC,EAAD,EAAWX,IAAX,EAAoB;AAChC,WAAO1B,QAAQ,CAACsC,GAAT,CAAc,YAAWD,EAAG,EAA5B,EAA+B,EAAC,GAAGX;AAAJ,KAA/B,EAA0CF,IAA1C,CAA+CC,GAAG,IAAEA,GAAG,CAACC,IAAxD,CAAP;AACH,GATmB;;AAUpBa,EAAAA,YAAY,CAACF,EAAD,EAASG,MAAT,EAAqB;AAC7B,UAAMC,MAAM,GAAG,OAAMJ,EAAG,WAAUG,MAAO,EAAzC;AACA,WAAOxC,QAAQ,CAAC0C,MAAT,CAAiB,WAAUD,MAAO,EAAlC,EAAuCjB,IAAvC,CAA4CC,GAAG,IAAGA,GAAG,CAACC,IAAtD,CAAP;AACH,GAbmB;;AAcpBiB,EAAAA,OAAO,CAACjB,IAAD,EAAyC;AAC5C,UAAM;AAACkB,MAAAA,KAAD;AAAOC,MAAAA;AAAP,QAAmBnB,IAAzB;AACA,WAAO1B,QAAQ,CAACsB,IAAT,CAAe,cAAf,EAA8B;AAACsB,MAAAA,KAAD;AAAOC,MAAAA;AAAP,KAA9B,EAAgDrB,IAAhD,CAAqDC,GAAG,IAAEA,GAAG,CAACC,IAA9D,CAAP;AACH,GAjBmB;;AAkBpBoB,EAAAA,MAAM,CAACpB,IAAD,EAAyC;AAC3C,WAAO1B,QAAQ,CAACsB,IAAT,CAAe,cAAf,EAA8BI,IAA9B,EAAoCF,IAApC,CAAyCC,GAAG,IAAEA,GAAG,CAACC,IAAlD,CAAP;AACH,GApBmB;;AAqBpBqB,EAAAA,UAAU,CAACV,EAAD,EAAW;AACjB,WAAOrC,QAAQ,CAACkC,GAAT,CAAc,cAAaG,EAAG,EAA9B,EAAiCb,IAAjC,CAAsCC,GAAG,IAAEA,GAAG,CAACC,IAA/C,CAAP;AACH,GAvBmB;;AAwBpBsB,EAAAA,UAAU,CAACtB,IAAD,EAAU;AAChB,WAAO1B,QAAQ,CAACsB,IAAT,CAAe,YAAf,EAA4BI,IAA5B,EAAkCF,IAAlC,CAAuCC,GAAG,IAAEA,GAAG,CAACC,IAAhD,CAAP;AACH;;AA1BmB,CAAjB","sourcesContent":["import axios from \"axios\";\nimport {cars} from \"../Redux/reducers/folderPageReducer\";\nimport {useSelector} from \"react-redux\";\nimport {AppStateType} from \"../Redux/Redux-store\";\n\n\nconst instance = axios.create({\n    baseURL: 'http://192.168.43.38:9000/',\n})\n\ninstance.interceptors.request.use((config) => {\n    let accessToken = JSON.parse(String(localStorage.getItem('profile')));\n    //@ts-ignore\n    config.headers.Authorization = `Bearer ${ accessToken && accessToken.accessToken}`\n    return config;\n})\ninstance.interceptors.response.use((config)=>{\n    return config;\n},(async error => {\n    const originalRequest = error.config;\n    if(error.response.status == 401 && error.config && !error.config._isRetry){\n        originalRequest._isRetry = true;\n        try{\n            const access = JSON.parse(String(localStorage.getItem('profile')));\n            const responce = await instance.post(`auth/refresh`, {\"token\": access.refreshToken}).then(res=> res.data.accessToken);\n            access.accessToken = responce;\n            await localStorage.setItem('profile', JSON.stringify(access));\n            return instance.request(originalRequest);\n        } catch (e){\n            console.log('НЕ АВТОРЕЗОВАН')\n        }\n    }\n    throw error;\n}))\nexport const adminApi = {\n    getGoods() {\n        return instance.get<Array<cars>>(`api/cars`).then(res=> res.data);\n    },\n    addNewFolder(data:any){\n        return instance.post(`api/cars`, {...data}).then(res=>res.data);\n    },\n    updateFolderName(id:string,data:any){\n        return instance.put(`api/cars/${id}`, {...data}).then(res=>res.data);\n    },\n    deleteFolder(id:any, userId:any) {\n        const mainId= `?id=${id}&userId=${userId}`;\n        return instance.delete(`api/cars${mainId}`, ).then(res=> res.data);\n    },\n    loginMe(data:{email: string, password: string}) {\n        const {email,password} = data;\n        return instance.post(`/auth/signIn`, {email,password}).then(res=>res.data);\n    },\n    signUp(data:{email: string, password: string}) {\n        return instance.post(`/auth/signUp`, data).then(res=>res.data);\n    },\n    getFolders(id:string){\n        return instance.get(`/api/users/${id}`).then(res=>res.data);\n    },\n    addIdOfCar(data:any){\n        return instance.post(`/api/users`, data).then(res=>res.data);\n    }\n\n}"]},"metadata":{},"sourceType":"module"}